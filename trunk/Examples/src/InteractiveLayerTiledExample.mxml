<?xml version="1.0" encoding="utf-8"?>
<FlexiWeatherTemplate xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx"
		minWidth="955" minHeight="600" xmlns:widgets="com.iblsoft.flexiweather.widgets.*"
		xmlns="*">
	<fx:Declarations>

		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<s:VGroup width="100%" height="100%" gap="2" paddingTop="10" paddingBottom="10"
			paddingLeft="10" paddingRight="10">
		<s:HGroup id="hboxCaption" width="100%" verticalAlign="middle">
			<s:Label text="This example demonstrates use of InteractiveLayerTiled."
					fontWeight="bold" fontSize="14"/>
			<s:Label id="labelProgress" textAlign="right" fontWeight="bold"/>
		</s:HGroup>
		<s:HGroup width="100%" height="100%">
			<widgets:InteractiveWidget id="m_iw" width="100%" height="100%">
				<widgets:InteractiveLayerZoom id="m_ilz" zOrder="1"/>
				<widgets:InteractiveLayerPan id="m_ilp" zOrder="2"/>
				<widgets:InteractiveLayerMap id="ilm" width="100%" height="100%"/>
			</widgets:InteractiveWidget>
		</s:HGroup>
	</s:VGroup>
	<fx:Script>
		<![CDATA[
			import com.iblsoft.flexiweather.ogc.BBox;
			import com.iblsoft.flexiweather.ogc.InteractiveLayerQTTMS;
			import com.iblsoft.flexiweather.ogc.configuration.layers.QTTMSLayerConfiguration;
			import com.iblsoft.flexiweather.ogc.configuration.layers.TiledLayerConfiguration;
			import com.iblsoft.flexiweather.ogc.tiling.InteractiveLayerTiled;
			import com.iblsoft.flexiweather.ogc.tiling.TileMatrix;
			import com.iblsoft.flexiweather.ogc.tiling.TileMatrixLimits;
			import com.iblsoft.flexiweather.ogc.tiling.TileMatrixSet;
			import com.iblsoft.flexiweather.ogc.tiling.TileMatrixSetLimits;
			import com.iblsoft.flexiweather.ogc.tiling.TileMatrixSetLink;
			import com.iblsoft.flexiweather.proj.Projection;
			
			import mx.containers.Tile;
			import mx.events.FlexEvent;
			private var _tms900913: TileMatrixSet;
			private var _tiledLayer: InteractiveLayerTiled;
			private var _qttLayer: InteractiveLayerQTTMS;

			override protected function onCreationComplete(event: FlexEvent): void
			{
				super.onCreationComplete(event);
			
				Projection.addCRSByProj4("ESRI:54004", "+title=World Mercator +proj=merc +lat_ts=0 +lon_0=0 +k=1.000000 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m");
				Projection.addCRSByProj4("ESRI:102018", "+title=North Pole Stereographic +proj=stere +lat_0=90 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m");
				Projection.addCRSByProj4("ESRI:102021", "+title=South Pole Stereographic +proj=stere +lat_0=-90 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m");
				scm.update(scm.getAllServicesNames());
				
				m_iw.setCRSExtentAndViewBBox('EPSG:900913');
				
				createInteractiveLayerQTTMS();
			}
			
			private function createInteractiveLayerQTTMS(): void
			{
				var qttConfig: QTTMSLayerConfiguration = new QTTMSLayerConfiguration();
				qttConfig.label = 'openstreetmap';
				
				_qttLayer = qttConfig.createInteractiveLayer(m_iw) as InteractiveLayerQTTMS;
				_qttLayer.addCRSWithTilingExtent('http://b.tile.openstreetmap.org/%ZOOM%/%COL%/%ROW%.png', 'EPSG:900913', new BBox(-20037508.34, -20037508.34, 20037508.34, 20037508.34), 256, 0, 18);
				
				m_iw.interactiveLayerMap.addLayer(_qttLayer);
//				_qttLayer.refresh(true);
			}
			
		]]>
	</fx:Script>
</FlexiWeatherTemplate>
